import numpy as np
import pytest
from numpy.testing import assert_array_almost_equal

from copulae.special.dilog import dilog


@pytest.mark.parametrize('x, exp', [
    (np.arange(0, 3.1, 0.1),
     [0, 0.102617791099391, 0.211003775439705, 0.326129510075476, 0.449282974471282, 0.582240526465013,
      0.727586307716333, 0.889377624286039, 1.07479460000825, 1.29971472300496, 1.64493406684823, 1.96199910130557,
      2.12916943038396, 2.24088783985365, 2.31907303630966, 2.37439527027248, 2.41313113797463, 2.43935427088584,
      2.4558764585043, 2.46472330248959, 2.46740110027234, 2.46505797538081, 2.45858660199974, 2.44869251574337,
      2.43594109904594, 2.42079080656593, 2.40361721226863, 2.38473076153774, 2.36439010232858, 2.34281224729354,
      2.3201804233131])
])
def test_dilog(x, exp):
    assert_array_almost_equal(dilog(x), exp)
